<%- include('../partials/header') %>

<h1>All Sleep Logs</h1>
<p><%= profile.firstName %></p>

<button>
    <a href="/profiles/<%= user.profile._id %>/sleeps/new" class="btn btn-primary">New Sleep Log</a>  
</button>


<button>
    <a href="/profiles/<%= user.profile._id %>/update" class="btn btn-primary">Update Profile</a>
</button>
  

<table>
  <thead>
    <tr>
      <th>Sleep Hours</th>
      <th>Sleep Quality</th>
      <th>Dreamed</th>
      <th>Goal Achieved?</th> <!-- Add a new column for the checkmark -->
      <th>Details</th>
      <th>Delete</th> <!-- Add a new column for the delete button -->
    </tr>
  </thead>
  <tbody>
    <% profile.sleepLogs.forEach((sleepLog) => { %>
      <tr>
        <td><%= sleepLog.sleepDuration.hours %>H:<%=sleepLog.sleepDuration.minutes %>M </td>
        <td><%= sleepLog.sleepQuality %></td>
        <td><%= sleepLog.dreamed ? 'Yes' : 'No' %></td>
        <td>
          <% if (sleepLog.sleepDuration.hours > profile.sleepGoal.hours || (sleepLog.sleepDuration.hours === profile.sleepGoal.hours && sleepLog.sleepDuration.minutes > profile.sleepGoal.minutes)) { %>
            &#10004; <!-- Insert a checkmark -->
          <% } %>
        </td>
        <td>
            <form action="/profiles/<%= user.profile._id %>/sleeps/<%= sleepLog._id %>" method="GET">
              <button type="submit">View Details</button>
            </form>
        </td>
        <td>
            <form action="/profiles/<%= profile._id %>/sleeps/<%= sleepLog._id %>?_method=DELETE" method="POST" onsubmit="return confirm('Are you sure you want to delete this sleep log?');"></form><form action="/profiles/<%= user.profile._id %>/sleeps/<%= sleepLog._id %>" method="POST" onsubmit="return confirm('Are you sure you want to delete this sleep log?');">
              <button type="submit">Delete</button>
            </form>
        </td>
      </tr>
    <% }) %>
  </tbody>
</table>

<%- include('../partials/footer') %>
