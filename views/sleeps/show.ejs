<%- include('../partials/header') %>

<h1>Sleep Log Details</h1>

<table>
  <thead>
    <tr>
      <th>Sleep Start</th>
      <th>Sleep End</th>
      <th>Sleep Goal</th>
      <th>Sleep Duration</th>
      <th>Quality</th>
      <th>Met Goal</th>
      <th>Dreamed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><%= sleep.sleepStart.toLocaleString() %></td>
      <td><%= sleep.sleepEnd.toLocaleString() %></td>
      <td><%= profile.sleepGoal.hours %>H:<%= profile.sleepGoal.minutes %>M</td>
      <td><%= sleep.sleepDuration.hours %>H:<%= sleep.sleepDuration.minutes %>M</td>
      <td><%= sleep.sleepQuality %></td>
      <td>
        <% if (sleep.sleepDuration.hours > profile.sleepGoal.hours || (sleep.sleepDuration.hours === profile.sleepGoal.hours && sleep.sleepDuration.minutes > profile.sleepGoal.minutes)) { %>
          &#10004;
        <% } else { %>
          failed
        <% } %>
      </td>
      <td><%= sleep.dreamed ? 'Yes' : 'No' %></td>
    </tr>
  </tbody>
</table>

<!-- Button to create a new dream log -->
<button>
<a href="/profiles/<%= user.profile._id %>/sleeps/<%= sleep._id %>/dreams/new">Add Dream Log</a>
</button>
<table>
    <thead>
      <tr>
        <th>Title</th>
        <th>Action</th>
        <th>Delete</th>
      </tr>
    </thead>
    <tbody>
      <% sleep.dreamLogs.forEach((dream) => { %>
      <tr>
        <td><%= dream.title %></td>
        <td>
          <form action="/profiles/<%= user.profile._id %>/sleeps/<%= sleep._id %>/dreams/<%= dream._id %>" method="GET">
            <button type="submit">Show</button>
          </form>
        </td>
        <td>
            <form action="/profiles/<%=profile._id %>/sleeps/<%= sleep._id %>/dreams/<%= dream._id %>?_method=DELETE" method="POST">
                <button type="submit">Delete</button>
              </form>
        </td>
      </tr>
      <% }) %>
    </tbody>
  </table>
  
  

<%- include('../partials/footer') %>